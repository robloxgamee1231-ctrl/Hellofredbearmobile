<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Hello Neighbor: Chromebook Edition</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        #boot-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #111; z-index: 9999; display: flex; flex-direction: column;
            align-items: center; justify-content: center; color: white;
        }
        #play-btn { 
            padding: 20px 60px; font-size: 24px; background: #228B22; border: 4px solid white; 
            border-radius: 10px; cursor: pointer; color: white; font-weight: bold;
        }
        .instructions { color: #888; margin-top: 15px; font-size: 14px; }
    </style>
</head>
<body>

    <div id="boot-screen">
        <h1 style="color: #ffcc00; margin-bottom: 5px;">HELLO NEIGHBOR</h1>
        <p style="color: #eee; margin-bottom: 20px;">Chromebook Build: Pointer Lock Enabled</p>
        <button id="play-btn" onclick="enterGame()">CLICK TO PLAY</button>
        <div class="instructions">WASD to Move | Mouse to Look | F for Flashlight</div>
    </div>

    <a-scene xr-mode-ui="enabled: false" embedded shadow="type: basic">
        
        <a-assets>
            <img id="grassTex" src="https://i.imgur.com/v5fS09X.png">
            <img id="roadTex" src="https://i.imgur.com/2mP7Y78.jpeg">
        </a-assets>

        <a-sky color="#87CEEB"></a-sky>
        <a-light type="ambient" intensity="0.7"></a-light>
        <a-light type="directional" intensity="0.6" position="-1 10 2" castShadow="true"></a-light>

        <a-plane position="0 0 0" rotation="-90 0 0" width="200" height="200" src="#grassTex" repeat="50 50"></a-plane>
        <a-plane position="0 0.05 0" rotation="-90 0 0" width="10" height="200" src="#roadTex" repeat="1 20"></a-plane>

        <a-entity position="-15 0 10">
            <a-box position="0 3 0" width="10" height="6" depth="10" color="blue"></a-box>
            <a-cone position="0 7 0" radius-bottom="8" height="4" color="#333"></a-cone>
        </a-entity>

        <a-entity position="15 0 -10">
            <a-box position="0 4 0" width="15" height="8" depth="15" color="#4a301d"></a-box>
            <a-box position="0 10 0" width="10" height="6" depth="10" color="#3d2b1f"></a-box> <a-box position="0 4 8" width="4" height="6" depth="1" color="#222"></a-box> </a-entity>

        <a-entity position="-10 0 -20">
            <a-cylinder color="brown" radius="0.2" height="2"></a-cylinder>
            <a-sphere color="green" radius="1.5" position="0 2 0"></a-sphere>
        </a-entity>
        <a-entity position="10 0 20">
            <a-cylinder color="brown" radius="0.2" height="2"></a-cylinder>
            <a-sphere color="green" radius="1.5" position="0 2 0"></a-sphere>
        </a-entity>

        <a-entity id="rig" movement-controls="controls: keyboard, joystick; speed: 0.25" position="0 0 30">
            <a-entity id="camera" camera position="0 1.6 0" look-controls="pointerLockEnabled: true">
                
                <a-sphere position="-0.4 -0.4 -0.6" radius="0.08" color="#f1c27d">
                    <a-box position="0 0 -0.1" width="0.1" height="0.05" depth="0.2" color="#ffff00"></a-box> </a-sphere>
                <a-sphere position="0.4 -0.4 -0.6" radius="0.08" color="#f1c27d">
                    <a-box position="0 0 -0.1" width="0.1" height="0.05" depth="0.2" color="#ffff00"></a-box> </a-sphere>

                <a-entity id="flashlight" light="type: spot; intensity: 0; distance: 25; angle: 45"></a-entity>
            </a-entity>
        </a-entity>

        <a-entity id="neighbor" position="15 0 -5">
            <a-box position="0 1 0" width="0.6" height="2" color="purple"></a-box> <a-sphere position="0 2.2 0" radius="0.35" color="#f1c27d"></a-sphere> <a-box position="0 2.2 0.3" width="0.4" height="0.1" depth="0.1" color="black"></a-box> <a-entity light="type: point; color: red; intensity: 1.5; distance: 5" position="0 2 0.5"></a-entity>
        </a-entity>

    </a-scene>

    <script>
        let isStarted = false;
        let fOn = false;

        function enterGame() {
            document.getElementById('boot-screen').style.display = 'none';
            isStarted = true;
            document.querySelector('a-scene').play();
            // This locks the mouse to the center for Chromebook
            document.body.requestPointerLock();
        }

        // F Key for Flashlight
        window.addEventListener('keydown', (e) => {
            if (e.key.toLowerCase() === 'f') {
                fOn = !fOn;
                document.querySelector('#flashlight').setAttribute('light', 'intensity', fOn ? 2.5 : 0);
            }
        });

        // Neighbor AI
        setInterval(() => {
            if (!isStarted) return;

            const neighbor = document.querySelector('#neighbor').object3D.position;
            const rig = document.querySelector('#rig').object3D.position;
            const speed = 0.05;

            // Simple movement toward player
            if (neighbor.x < rig.x) neighbor.x += speed; else neighbor.x -= speed;
            if (neighbor.z < rig.z) neighbor.z += speed; else neighbor.z -= speed;

            // Rotation - Neighbor faces you
            document.querySelector('#neighbor').setAttribute('look-at', '#rig');

            // Catch Condition
            let dist = Math.sqrt(Math.pow(neighbor.x - rig.x, 2) + Math.pow(neighbor.z - rig.z, 2));
            if (dist < 2.5) {
                alert("THE NEIGHBOR CAUGHT YOU!");
                location.reload();
            }
        }, 50);
    </script>
</body>
</html>
